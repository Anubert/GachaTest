<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chaos Gacha</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body style="background-image: url('assets/relax.gif'); background-size: cover; background-position: center;">

  <!-- Settings Toggle Icon -->
  <div id="settings-toggle" onclick="openSettings()">⚙️</div>

  <!-- Overlay -->
  <div id="settings-overlay" class="hidden" onclick="closeSettings()"></div>

  <!-- Sliding Settings Panel -->
  <div id="settings-panel" class="hidden">
    <h3>Settings</h3>
    <label><input type="checkbox" id="soundToggle" checked /> Enable Sound</label><br>
    <label><input type="checkbox" id="animToggle" checked /> Enable Animations</label><br>
    <a href="about.html" target="_blank">About</a>
    <button class="close-btn" onclick="closeSettings()">Close</button>
  </div>

  <!-- Audio Elements -->
  <audio id="clickSound" src="assets/audio/click.mp3"></audio>
  <audio id="clickRareSound" src="assets/audio/click_rare.mp3"></audio>
  <audio id="hoverRareSound" src="assets/audio/hover_rare.mp3"></audio>
  <audio id="trashSound" src="assets/audio/trash.mp3"></audio>
  <audio id="winSound" src="assets/audio/win.mp3"></audio>
  <audio id="winRareSound" src="assets/audio/win_rare.mp3"></audio>

  <div class="container">
    <!-- ... your existing category, result, tier-buttons, inputs ... -->
  </div>

  <script src="main.js"></script>
  <script>
    // Settings pane control
    function openSettings() {
      document.getElementById('settings-overlay').classList.remove('hidden');
      document.getElementById('settings-panel').classList.remove('hidden');
      // trigger reflow then slide in
      requestAnimationFrame(() =>
        document.getElementById('settings-panel').classList.add('visible')
      );
    }
    function closeSettings() {
      document.getElementById('settings-panel').classList.remove('visible');
      document.getElementById('settings-overlay').classList.add('hidden');
      // after panel slides out, hide it
      document.getElementById('settings-panel')
        .addEventListener('transitionend', function hide() {
          document.getElementById('settings-panel').classList.add('hidden');
          this.removeEventListener('transitionend', hide);
        });
    }

    // Toggle sound/animation flags
    window.soundEnabled = true;
    window.animEnabled = true;
    document.getElementById('soundToggle')
      .addEventListener('change', e => window.soundEnabled = e.target.checked);
    document.getElementById('animToggle')
      .addEventListener('change', e => window.animEnabled = e.target.checked);

    // Wrap existing functions
    const origPlayClick = playClickSound;
    playClickSound = btn => { if (soundEnabled) origPlayClick(btn); };
    const origPlayHover = playHoverSound;
    playHoverSound = btn => { if (soundEnabled) origPlayHover(btn); };
    const origDraw = draw;
    draw = cat => {
      if (animEnabled) {
        document.getElementById('result').classList.add('pulse');
        setTimeout(() => {
          document.getElementById('result').classList.remove('pulse');
          origDraw(cat);
        }, 300);
      } else origDraw(cat);
    };
  </script>
</body>
</html>
